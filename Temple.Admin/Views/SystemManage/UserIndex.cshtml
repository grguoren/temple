@{
    ViewBag.Title = "無極證道-管理系統-使用者基本資料管理";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="page-header position-relative">
    <h1>
        系统管理
        <small>
            <i class="icon-double-angle-right"></i>
            使用者基本資料管理
        </small>
    </h1>
</div>

<div class="row-fluid" ms-controller="userList">
    <div class="span12">
        <div class="table-responsive">
            <div class="well well-lg">
                <button type="button" class="btn btn-xs btn-success" data-target="#addUser_Modal" data-toggle="modal" ms-click="add()">
                    <i class="icon-plus-sign"></i>
                    新增資料
                </button>
@*                <span>使用者姓名：</span>
                <span>
                    <input type="text" class="input-xs" id="Search_NickName" />
                </span>
                <span>用户名：</span>
                <span>
                    <input type="text" class="input-xs" id="Search_UserName" />
                </span>
                <button type="button" class="btn btn-xs btn-success" ms-click="getList(1)">
                    <i class="icon-search"></i>
                    查询
                </button>
                <button type="button" class="btn btn-xs btn-danger" ms-click="Search_Clear()">
                    <i class="icon-repeat"></i>
                    清空
                </button>*@
            </div>

            <div class="span12 avalonloading"><i class="icon-spinner icon-spin orange bigger-125"></i></div>

            <table id="sample-table-1" class="table table-bordered table-hover no-margin-bottom">
                <thead>
                    <tr>
                        <th width="120px">操作</th>
                        <th>使用者姓名</th>
                        <th>所属部门</th>
                        <th>用户名</th>
                        <th>登陆密码</th>
                        <th>最近登陆时间</th>
                        <th>创建时间</th>
                    </tr>
                </thead>

                <tbody>
                    <tr ms-if="!ListLoading"><td colspan="19" style="text-align:center;"><i class="icon-spinner icon-spin orange bigger-125"></i></td></tr>
                    <tr ms-if="!ListNoData"><td colspan="18" style="text-align:center;">对不起,没有数据!</td></tr>
                    <tr ms-repeat="array" ms-visible="ListLoading">
                        <td>
                            <button title="设置角色" class="btn btn-xs" ms-click="getRoleList(el)" data-target="#setRole_Modal_UserIndex" data-toggle="modal"><i class="icon-sitemap"></i></button>
                            @if (ViewBag.ReplyName == "zhihupz" || ViewBag.ReplyName == "adminzh")
                            { 
                                <span><button title="编辑" class="btn btn-xs btn-primary" ms-click="edit(el)" data-target="#addUser_Modal" data-toggle="modal"><i class="icon-edit"></i></button></span>
                            }
                            else
                            {
                            <span ms-if="(el.UserName !='zhihupz')"><button title="编辑" class="btn btn-xs btn-primary" ms-click="edit(el)" data-target="#addUser_Modal" data-toggle="modal"><i class="icon-edit"></i></button></span>
                            }

                            <button title="删除" class="btn btn-xs btn-danger" ms-click="removeUser(el.ID)"><i class="icon-trash"></i></button>
                        </td>
                        <td><input type="text" ms-duplex="el.NickName" style="width:120px;" /> </td> 
                        <td><input type="text" ms-duplex="el.DepartName" style="width:120px;" /> </td>
                        <td><input type="text" ms-duplex="el.UserName" style="width:120px;" /></td>
                        <td><input type="text" ms-duplex="el.Pwd" style="width:120px;" />
                            <a title="修改资料" href="javascript:;" ms-click="EditData(el.ID,el.NickName,el.DepartName,el.UserName,el.Pwd)">修改</a>  
                        </td>
                        <td>{{el.UpdateTime| date("yyyy/MM/dd HH:mm")}}</td>
                        <td>{{el.CreateTime| date("yyyy/MM/dd HH:mm")}}</td>
                    </tr>
                </tbody>
            </table>
            <div ms-widget="pager,pp"></div>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="addUser_Modal" tabindex="-1" role="dialog" style="margin-top:170px;">
        <div class="modal-dialog">
            <div class="modal-content" style="width:230px;">
                <div class="modal-header no-padding">
                    <div class="table-header" style="line-height:32px;">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        {{type}}用户
                    </div>
                </div>
                <div class="modal-body">
                    <div class="control-group">
                        <label class="control-label" for="form-field-username">用户账号</label>
                        <div class="controls">
                            <input type="text" id="form-field-username" placeholder="用户账号" ms-duplex="UserName" />
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="form-field-nickname">用户姓名</label>
                        <div class="controls">
                            <input type="text" id="form-field-nickname" placeholder="用户姓名" ms-duplex="NickName" />
                        </div>
                    </div>
                     <div class="control-group">
                        <label class="control-label" for="form-field-nickname">所属部门</label>
                        <div class="controls">
                            <input type="text" id="form-field-dpartname" placeholder="所属部门" ms-duplex="DepartName" />
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="form-field-pwd">用户密码</label>
                        <div class="controls">
                            <input type="text" id="form-field-pwd" placeholder="用户密码" ms-duplex="PWD" />
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">关闭</button>
         
                        <button type="button" class="btn btn-primary btn-sm" ms-click="update()">{{type}}</button>
                          
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="setRole_Modal_UserIndex" tabindex="-1" role="dialog" style="margin-top:170px;">
        <div class="modal-dialog">
            <div class="modal-content" style="width:500px;">
                <div class="modal-header no-padding">
                    <div class="table-header" style="line-height:32px;">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        设置角色
                    </div>
                </div>
                <div class="modal-body">
                    <div class="control-group">
                        <label class="control-label bolder blue">请给用户[{{RoleDom.userName}}]选择角色</label>

                        <div class="checkbox" ms-repeat="RoleDom.roleList">
                            <label>
                                <input name="form-field-checkbox" type="checkbox" class="ace" ms-duplex-string="RoleDom.selectList" ms-attr-value="el.ID" />
                                <span class="lbl"> {{el.Name}}</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-sm btn-primary" ms-click="updateRoleUser()">保存</button>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts{
@*<script src="@Url.Content("~/Scripts/Page/SystemManage/UserIndex.js")"></script>*@
}
